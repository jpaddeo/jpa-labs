(function(b){function i(a,d){this.$element=b(a);this.options=d;this.enabled=!0;this.fixTitle()}i.prototype={show:function(){var a=this.getTitle(),d=this.options;if(a&&this.enabled){var c=this.tip();c.find("."+d.clsStyle+"-inner")[this.options.html?"html":"text"](a);c[0].className=d.clsStyle+"";c.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var a=b.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),
f=c[0].offsetWidth,g=c[0].offsetHeight,h="function"==typeof this.options.gravity?this.options.gravity.call(this.$element[0]):this.options.gravity,e;switch(h.charAt(0)){case "n":e={top:a.top+a.height+this.options.offset,left:a.left+a.width/2-f/2};break;case "s":e={top:a.top-g-this.options.offset,left:a.left+a.width/2-f/2};break;case "e":e={top:a.top+a.height/2-g/2,left:a.left-f-this.options.offset};break;case "w":e={top:a.top+a.height/2-g/2,left:a.left+a.width+this.options.offset}}2==h.length&&(e.left=
"w"==h.charAt(1)?a.left+a.width/2-15:a.left+a.width/2-f+15);c.css(e).addClass(d.clsStyle+"-"+h);c.find("."+d.clsStyle+"-arrow")[0].className=d.clsStyle+"-arrow "+d.clsStyle+"-arrow-"+h.charAt(0);this.options.className&&c.addClass("function"==typeof this.options.className?this.options.className.call(this.$element[0]):this.options.className);this.options.fade?c.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):c.css({visibility:"visible",opacity:this.options.opacity})}},
hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){b(this).remove()}):this.tip().remove()},fixTitle:function(){var a=this.$element;if(a.attr("title")||"string"!=typeof a.attr("original-title"))a.attr("original-title",a.attr("title")||"").removeAttr("title")},getTitle:function(){var a,b=this.$element,c=this.options;this.fixTitle();c=this.options;"string"==typeof c.title?a=b.attr("title"==c.title?"original-title":c.title):"function"==typeof c.title&&(a=c.title.call(b[0]));return(a=
(""+a).replace(/(^\s*|\s*$)/,""))||c.fallback},tip:function(){var a=this.options;this.$tip||(this.$tip=b('<div class="'+a.clsStyle+'"></div>').html('<div class="'+a.clsStyle+'-arrow"></div><div class="'+a.clsStyle+'-inner"></div>'));return this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.options=this.$element=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}};b.fn.tipsy=function(a){function d(e){var c=
b.data(e,"tipsy");c||(c=new i(e,b.fn.tipsy.elementOptions(e,a)),b.data(e,"tipsy",c));return c}function c(){var b=d(this);b.hoverState="in";0==a.delayIn?b.show():(b.fixTitle(),setTimeout(function(){"in"==b.hoverState&&b.show()},a.delayIn))}function f(){var b=d(this);b.hoverState="out";0==a.delayOut?b.hide():setTimeout(function(){"out"==b.hoverState&&b.hide()},a.delayOut)}if(!0===a)return this.data("tipsy");if("string"==typeof a){var g=this.data("tipsy");if(g)g[a]();return this}a=b.extend({},b.fn.tipsy.defaults,
a);a.live||this.each(function(){d(this)});if("manual"!=a.trigger){var g=a.live?"live":"bind",h="hover"==a.trigger?"mouseleave":"blur";this[g]("hover"==a.trigger?"mouseenter":"focus",c)[g](h,f)}return this};b.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!0,live:!1,offset:0,opacity:1,title:"title",trigger:"hover",clsStyle:"tipsy"};b.fn.tipsy.elementOptions=function(a,d){return b.metadata?b.extend({},d,b(a).metadata()):d};b.fn.tipsy.autoNS=function(){return b(this).offset().top>
b(document).scrollTop()+b(window).height()/2?"s":"n"};b.fn.tipsy.autoWE=function(){return b(this).offset().left>b(document).scrollLeft()+b(window).width()/2?"e":"w"};b.fn.tipsy.autoBounds=function(a,d){return function(){var c=d[0],f=1<d.length?d[1]:!1,g=b(document).scrollTop()+a,h=b(document).scrollLeft()+a,e=b(this);e.offset().top<g&&(c="n");e.offset().left<h&&(f="w");b(window).width()+b(document).scrollLeft()-e.offset().left<a&&(f="e");b(window).height()+b(document).scrollTop()-e.offset().top<a&&
(c="s");return c+(f?f:"")}}})(jQuery);
